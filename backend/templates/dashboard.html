<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>

<div class="layout">
<aside class="sidebar">
  <h2>⚙ Automation</h2>
  <a class="active">Dashboard</a>
  <a href="/audit">Audit Logs</a>
  <div class="sidebar-footer">
    {{ role }}<br>
    <a href="/logout">Logout</a>
  </div>
</aside>

<main class="content">

<div class="page-header">
  <h1>Process Overview</h1>
  <p>Enterprise Workflow Management</p>
</div>

<div class="stats">
  <div class="stat-card"><span>Total</span><h2>{{ total }}</h2></div>
  <div class="stat-card approved"><span>Approved</span><h2>{{ approved }}</h2></div>
  <div class="stat-card rejected"><span>Rejected</span><h2>{{ rejected }}</h2></div>
  <div class="stat-card pending"><span>Pending</span><h2>{{ pending }}</h2></div>
</div>

{% if role == "Employee" %}
<div class="table-card">
<form action="/tasks/create" method="POST">
<input name="title" placeholder="Task title" required>
<input name="assigned_to" placeholder="Assign to User ID" required>
<button class="btn approve">Create Task</button>
</form>
</div>
{% endif %}

<div class="table-card" style="margin-top:30px">
<table>
<tr>
<th>ID</th><th>Task</th><th>Assigned</th><th>Status</th><th>Action</th>
</tr>
{% for t in tasks %}
<tr>
<td>{{ t[0] }}</td>
<td>{{ t[1] }}</td>
<td>{{ t[2] }}</td>
<td><span class="badge {{ t[3]|lower }}">{{ t[3] }}</span></td>
<td>
{% if role=="Manager" and t[3]=="Pending" %}
<a class="btn approve" href="/tasks/approve/{{ t[0] }}">Approve</a>
<a class="btn reject" href="/tasks/reject/{{ t[0] }}">Reject</a>
{% else %}—{% endif %}
</td>
</tr>
{% endfor %}
</table>
</div>

</main>
</div>
</body>
</html>
